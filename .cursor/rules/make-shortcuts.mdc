---
description: Prefer Make and shell shortcuts when suggesting commands in exarp-go
alwaysApply: true
---

# Make and shell shortcuts (exarp-go)

**Use these shortcuts when suggesting shell commands so the user can run less typing.**

## Makefile shortcuts

| Instead of           | Use      | When suggesting |
|----------------------|----------|------------------|
| `make build`         | `make b`  | Building the Go binary |
| (none)               | `make r`  | Print repo root (e.g. for scripts) |
| (none)               | `make root` | Same as `make r` |
| long path            | `cd $(make r)` | Change to project root from anywhere in repo |
| (none)               | `make tag-build-ok` | Tag current commit as last known-good build |
| `git push`           | `make push` or `make p` | Push from repo root (works from any subdir) |
| `git pull`           | `make pull` or `make pl` | Pull from repo root (works from any subdir) |
| `git status`         | `make status` or `make st` | Status from repo root (works from any subdir) |
| `gofmt -w ./...`     | `make fmt`   | Formatting Go code (NEVER run gofmt directly) |
| `go mod tidy`        | `make tidy`  | Cleaning up module dependencies |
| `go test ./...`      | `make test`  | Running tests (NEVER run go test directly) |
| `golangci-lint run`  | `make lint`  | Linting (NEVER run linter directly) |
| (fix all scorecard)  | `make scorecard-fix` | Auto-fix all fixable scorecard issues (tidy + fmt + lint) |
| task show one        | `make task-show TASK_ID=T-123` | Show full task details |
| task + local AI      | `make task-run-with-ai TASK_ID=T-123 [BACKEND=ollama]` | Run task through FM/Ollama/MLX |
| security scan only   | `make check-security` | Run exarp-go security scan (no govulncheck) |
| queue usage hints    | `make queue-status` | Show REDIS_ADDR and enqueue/worker/dispatcher hints |
| remove binary        | `make clean-binary` | Remove bin/exarp-go (then make build for full rebuild) |
| Ansible in Docker    | `make ansible-docker-smoke` | Syntax-check playbook in Ubuntu container |
| AI navigability      | `make lint-nav` | Check file comments, package docs, magic strings |
| AI nav + fix hints   | `make lint-nav-fix` | Same with suggested fixes for each issue |

**Rules:**
- Prefer **`make b`** over `make build` in suggested commands and snippets.
- When a command must run from project root, suggest **`cd $(make r)`** first (or `r` if the user's shell has the alias).

## Shell alias (user's ~/.zshrc)

The user has in `~/.zshrc`:

```sh
alias r='cd $(git rev-parse --show-toplevel 2>/dev/null)'
```

- **Interactive use:** You can suggest **`r`** to cd to repo root from any subdir (any git repo).
- **Cd then make:** Use **`r`** then run make (e.g. `r && make b`), or **`cd $(make r)`** in scripts. For git push/pull/status, use **`make p`** / **`make pl`** / **`make st`** from any subdir—no cd needed.

**Git push/pull/status:** From repo root use **`make p`** / **`make pl`** / **`make st`**. From a subdir, use **`r && make st`** (or `make -C $(git rev-parse --show-toplevel) st`) so make runs with the root Makefile.

- **Scripts / non-interactive:** Prefer **`cd $(make r)`** so it works without relying on the alias.

## Checklist when suggesting commands

- [ ] Build → use `make b` (not `make build`).
- [ ] Need to be in project root → suggest **`r`** (interactive) or **`cd $(make r)`** (scripts).
- [ ] Cd then make → use **`r && make <target>`** or **`cd $(make r) && make <target>`**; or use **`make p`** / **`make pl`** / **`make st`** (no cd needed).
- [ ] Tag last good build → suggest `make tag-build-ok`.
- [ ] Push/pull/status → from root: `make p` / `make pl` / `make st`; from subdir: `r && make st` or `make -C $(git rev-parse --show-toplevel) st`.
- [ ] Format → use `make fmt` (NEVER `gofmt -w` or `go fmt` directly).
- [ ] Test → use `make test` (NEVER `go test` directly).
- [ ] Lint → use `make lint` or `make lint-fix` (NEVER run linter directly).
