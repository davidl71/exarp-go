---
description: MCP server configuration and integration guidelines for Cursor IDE
alwaysApply: true
---

# üîå MCP Server Configuration

**‚ö†Ô∏è CRITICAL: MCP Configuration for Cursor IDE Integration ‚ö†Ô∏è**

## Current MCP Servers

**Global config:** `~/.cursor/mcp.json` (single source for shared servers ‚Äî e.g. from devwisdom-go `make install-mcp-config`).

**Per-project exarp-go:** You can have exarp-go MCP **per project** so each workspace uses its own `.todo2` and project root. Use the project‚Äôs `.cursor/mcp.json` with an `exarp-go` entry and `PROJECT_ROOT`: `{{PROJECT_ROOT}}`. Cursor uses the workspace config when that folder is open. See [Per-project exarp-go MCP](#per-project-exarp-go-mcp) below.

Do not duplicate the full global server list in every repo; use project config only for exarp-go (and any other project-specific MCP overrides) so each project gets the right `PROJECT_ROOT`.

| Server | Purpose |
|--------|---------|
| **devwisdom** | DevWisdom Go MCP Server ‚Äî wisdom, advisors, guidance (used by exarp-go report briefings) |
| **exarp-go** | Exarp project management automation (this repo) ‚úÖ **ACTIVE** |
| **tractatus_thinking** | Tractatus Thinking MCP ‚Äî structured reasoning, logical analysis |
| **context7** | Context7 MCP ‚Äî advanced context and documentation retrieval (e.g. add_external_tool_hints) |
| **github** | GitHub MCP ‚Äî official; repos, issues, PRs (remote `api.githubcopilot.com`; OAuth or PAT). See [GitHub Docs](https://docs.github.com/en/copilot/how-tos/provide-context/use-mcp/set-up-the-github-mcp-server). |
| **gitmcp** | GitMCP ‚Äî free remote MCP for any GitHub repo; fetch/search docs and code (`gitmcp.io/owner/repo` or `gitmcp.io/docs`). See [idosal/git-mcp](https://github.com/idosal/git-mcp). |

### When to Use Context7 vs Web Search

**Prefer Context7** when you need:
- **Library or framework documentation** ‚Äî Call `resolve-library-id` with the library name, then `query-docs` with the library ID and your question.
- **Code examples** for a known package (Go, Ansible, React, etc.).
- **API or usage details** for a language, framework, or tool that Context7 indexes.

**Use web search** when you need:
- **Real-time or version-specific facts** (e.g. ‚Äúlatest stable Go version number‚Äù, ‚Äúcurrent release date‚Äù).
- **Project-specific repos or pages** (e.g. a GitHub repo not in Context7‚Äôs catalog).
- **Official announcements or URLs** that are not part of library docs.
- **Anything Context7 doesn‚Äôt cover** ‚Äî try Context7 first; fall back to web search if no suitable library ID or no useful answer.

**Context7 workflow:** `resolve-library-id` (query + libraryName) ‚Üí `query-docs` (libraryId + query). Do not call more than 3 times per question.

### When to Use GitMCP

**Prefer GitMCP** when you need:
- **Docs or code from a specific GitHub repo** ‚Äî e.g. this repo (`gitmcp.io/davidl71/exarp-go`) or another (add `gitmcp.io/owner/repo` to config, or use generic `gitmcp.io/docs` and specify repo per request).
- **Up-to-date README / llms.txt / code search** for a project the AI might not have in context ‚Äî reduces hallucinations by fetching from the live repo.
- **Repo-specific API usage or examples** when Context7 doesn‚Äôt index that project.

**Tools:** `fetch_*_documentation`, `search_*_documentation`, `search_*_code` (names vary by server URL). Use **Context7** for broad library/framework docs; use **GitMCP** for a known GitHub repo‚Äôs own docs and code.

### When to Use GitHub MCP

Use **GitHub MCP** when the task involves **GitHub primitives**: list/create/update issues or PRs, repo metadata, branch/commit context for Copilot, or workflows that need authenticated GitHub API access. It does not replace GitMCP (docs/code fetch) or Context7 (library docs).

### When to Use Tractatus

For **complex research or task decomposition**, call the **tractatus_thinking** MCP tool to decompose concepts into logical structure before implementation.

- **Use:** `operation="start"` with `concept="What is X?"` (or your question). Then `add` propositions, and `export` (e.g. `format="markdown"`) for the result.
- **When:** Fuzzy or bundled concepts, design/research phases, or when you need to see what must *all* be true (multiplicative structure). See `.cursor/skills/tractatus-decompose/SKILL.md` for the full workflow.

To install or replace: from devwisdom-go run `make install-mcp-config` (or `REPLACE=1` for template only). For **OpenCode** (TUI/IDE agent), see `docs/OPENCODE_INTEGRATION.md`.

## Configuration Guidelines

### Server Configuration Format
```json
{
  "mcpServers": {
    "server-name": {
      "command": "path/to/binary",
      "args": ["arg1", "arg2"],
      "env": {
        "VAR_NAME": "value",
        "PROJECT_ROOT": "{{PROJECT_ROOT}}"
      },
      "description": "Human-readable description"
    }
  }
}
```

### Environment Variables
- **PROJECT_ROOT**: Always use `{{PROJECT_ROOT}}` for workspace path substitution
- **Custom vars**: Add project-specific environment variables as needed
- **No secrets**: Never commit API keys or secrets to config file

### Per-project exarp-go MCP

To use exarp-go **per project** (each repo has its own tasks and PROJECT_ROOT):

1. In the **project** you want to use exarp-go in, create or edit `.cursor/mcp.json` (this file is gitignored in exarp-go; in other repos you may commit it or add `.cursor/mcp.json` to `.gitignore` and use an example).
2. Add only the `exarp-go` server (Cursor merges with your global `~/.cursor/mcp.json`):

**Binary in a sibling exarp-go clone (common for development):**
```json
{
  "mcpServers": {
    "exarp-go": {
      "command": "{{PROJECT_ROOT}}/../exarp-go/bin/exarp-go",
      "args": [],
      "env": { "PROJECT_ROOT": "{{PROJECT_ROOT}}" }
    }
  }
}
```

**Or use the wrapper script (builds if needed):**
```json
{
  "mcpServers": {
    "exarp-go": {
      "command": "{{PROJECT_ROOT}}/../exarp-go/run-exarp-go.sh",
      "args": [],
      "env": { "PROJECT_ROOT": "{{PROJECT_ROOT}}", "EXARP_WATCH": "0" }
    }
  }
}
```

Replace `../exarp-go` with the path to your exarp-go install relative to the project root (or use an absolute path). When you open project A, exarp-go uses project A‚Äôs `.todo2`; when you open project B, it uses project B‚Äôs `.todo2`. See `docs/examples/README.md` and `docs/examples/cursor-mcp-per-project.json`.

### Transport Protocol
- **STDIO**: Recommended for Cursor IDE integration
- **JSON-RPC 2.0**: Standard protocol for MCP communication
- **No HTTP/SSE**: Cursor uses STDIO transport exclusively

## Server Development Guidelines

### Binary Location
- **Development**: Build binary to `bin/exarp-go`
- **Production**: Install to system PATH or use absolute path
- **Testing**: Use relative path during development, absolute path in config

### Error Handling
- **Startup errors**: Log to stderr, exit with non-zero code
- **Runtime errors**: Return JSON-RPC error responses
- **Connection errors**: Cursor will retry automatically

### Logging
- **Stderr**: Use for error logs and diagnostics
- **Stdout**: Reserved for JSON-RPC communication
- **No file logging**: Rely on Cursor's log capture

## Integration Testing

### Manual Testing
```bash
# Test server startup
./bin/exarp-go

# Test with MCP client
# Use Cursor's MCP inspector or external client
```

### Cursor Integration
1. **Restart Cursor** after config changes
2. **Check MCP status** in Cursor settings
3. **Test tool invocation** via chat interface
4. **Verify resources** are accessible

## Migration Notes

### From Python to Go
- **Binary path**: Update from Python script to Go binary
- **Command format**: Change from `uv run python -m mcp_stdio_tools.server` to binary path
- **Environment**: Same environment variables, different execution model
- **Compatibility**: Maintain same tool/prompt/resource interfaces

### Framework-Agnostic Design
- **Configuration**: Framework selection via config file
- **No hard dependencies**: Core code independent of framework
- **Easy switching**: Change framework without code changes
- **Testing**: Mock adapters for unit testing

## Troubleshooting

### Common Issues
1. **Server not found**: Check binary path is correct
2. **Permission denied**: Ensure binary is executable (`chmod +x`)
3. **Connection failed**: Verify server starts without errors
4. **Tools not available**: Check server logs for registration errors

### Debug Steps
1. **Test binary directly**: Run binary manually to check for errors
2. **Check Cursor logs**: View MCP server logs in Cursor settings
3. **Validate JSON**: Ensure `~/.cursor/mcp.json` (or project override if used) is valid JSON
4. **Restart Cursor**: Required after config changes

## Best Practices

### Configuration Management
- ‚úÖ **Global config**: Use `~/.cursor/mcp.json` for shared servers (devwisdom, tractatus, context7, etc.); install via devwisdom-go `make install-mcp-config`.
- ‚úÖ **Per-project exarp-go**: Use the project‚Äôs `.cursor/mcp.json` to add only exarp-go (and any project-specific overrides) with `PROJECT_ROOT`: `{{PROJECT_ROOT}}` so each workspace gets the correct project root.
- ‚úÖ **Documentation**: Document each server's purpose and usage
- ‚úÖ **Validation**: Validate JSON syntax before committing
- ‚úÖ **Testing**: Test each server independently before adding to config

### Server Development
- ‚úÖ **Error handling**: Graceful error handling and reporting
- ‚úÖ **Logging**: Clear, actionable error messages
- ‚úÖ **Testing**: Comprehensive test coverage
- ‚úÖ **Documentation**: Clear API documentation for tools/prompts/resources

### Integration
- ‚úÖ **Compatibility**: Maintain backward compatibility during migration
- ‚úÖ **Testing**: Test all tools/prompts/resources after changes
- ‚úÖ **Monitoring**: Monitor server health and performance
- ‚úÖ **Updates**: Keep servers updated with latest versions
