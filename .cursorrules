# exarp-go Development Rules

## Plan execution (read when relevant)

When executing plan tasks or wave parallelization: main plan [.cursor/plans/exarp-go.plan.md](.cursor/plans/exarp-go.plan.md); parallel instructions [.cursor/plans/parallel-execution-subagents.plan.md](.cursor/plans/parallel-execution-subagents.plan.md). Rule: `.cursor/rules/plan-execution.mdc`.

## Cursor skills (read when relevant)

Project skills in `.cursor/skills/` ‚Äî read the SKILL.md when the user's request matches:

| Skill | Path | When to use |
|-------|------|-------------|
| report-scorecard | `.cursor/skills/report-scorecard/SKILL.md` | Project overview, scorecard, briefing, status. |
| task-workflow | `.cursor/skills/task-workflow/SKILL.md` | List, update, create, show, delete Todo2 tasks. |
| **session-handoff** | `.cursor/skills/session-handoff/SKILL.md` | End session (handoff), list all handoffs, resume. |
| **task-cleanup** | `.cursor/skills/task-cleanup/SKILL.md` | Bulk remove one-off or performance tasks; tasks "reappeared." Use batch delete (`task_ids`). |
| **lint-docs** | `.cursor/skills/lint-docs/SKILL.md` | Check broken references, validate doc links, lint markdown (gomarklint link check built-in). |
| use-exarp-tools | `.cursor/skills/use-exarp-tools/SKILL.md` | Which exarp-go tool to use; tasks, reports, health, automation. Discover usage via MCP (stdio://tools, tool_catalog) or make help ‚Äî do not run exarp-go --help. |
| thinking-workflow | `.cursor/skills/thinking-workflow/SKILL.md` | Chain tractatus (structure) + sequential (process) + exarp-go MCP (execute) for backlog enrichment, sprint planning, dependency analysis. |

Full index: `.cursor/skills/README.md`.

## Task Management Commands

**üö´ TASK CREATION: ALWAYS use exarp-go** ‚Äî Use `exarp-go task create` or `task_workflow` action=create. **Never use Todo2 MCP create_todos** when exarp-go is available.

**‚ö†Ô∏è CRITICAL: Task Status Updates ‚ö†Ô∏è**

When updating task status, **PREFER convenience commands** but allow fallback to direct tool calls:

### ‚úÖ PREFERRED: Convenience Commands

**Use convenience commands for common operations:**

```bash
# List tasks
exarp-go task list --status "In Progress"
exarp-go task list --status "Todo"
exarp-go task list --priority "high"

# Update task status
exarp-go task update T-123 --new-status "Done"
exarp-go task update --status "Todo" --new-status "Done" --ids "T-1,T-2"

# Create task
exarp-go task create "Task name" --description "Description" --priority "high"

# Show task details
exarp-go task show T-123
exarp-go task status T-123
```

### ‚ö†Ô∏è FALLBACK: Direct Tool Calls

**Use direct tool calls for advanced operations or when convenience commands don't support the operation:**

```bash
# Advanced operations (clarity, cleanup, etc.)
exarp-go -tool task_workflow -args '{"action":"clarity","task_id":"T-123"}'
exarp-go -tool task_workflow -args '{"action":"cleanup","stale_threshold_hours":24}'

# Batch operations with complex filters
exarp-go -tool task_workflow -args '{"action":"sync","sub_action":"list","status":"Review","filter_tag":"migration"}'
```

### Rules

1. **PREFER convenience commands** (`exarp-go task ...`) for:
   - Listing tasks by status/priority/tag
   - Updating single or multiple task statuses
   - Creating new tasks
   - Showing task details

2. **FALLBACK to direct tool calls** (`exarp-go -tool task_workflow ...`) for:
   - Advanced actions (clarity, cleanup, clarify)
   - Complex filtering not supported by convenience commands
   - Batch operations with custom parameters
   - Scripting/automation where JSON is more appropriate

3. **NEVER edit `.todo2/state.todo2.json` directly** - Always use `task_workflow` tool or convenience commands

4. **When in doubt**, use convenience commands first - they're simpler and more readable

5. **Standing rule: Mark Done when completable** ‚Äî When you complete work that satisfies a task, mark that task Done immediately.
   - **Prefer exarp-go**: `exarp-go task update --status "<current_status>" --new-status "Done" --ids "<task_id>"` or `exarp-go -tool task_workflow -args '{"action":"approve","status":"<current>","new_status":"Done","task_ids":"<id1>,<id2>"}'`.
   - **Fallback** (if exarp-go unavailable): Todo2 MCP `update_todos`: pass `updates: [{ "id": "<task_id>", "status": "Done" }]`.

## Makefile Task Commands

**Use Makefile targets for common task operations:**

```bash
# List tasks
make task-list-todo
make task-list-in-progress
make task-list-done
make task-list TASK_FLAGS="--status Todo --limit 10"

# Update task status
make task-update TASK_ID=T-123 NEW_STATUS=Done
```

## Examples

### ‚úÖ GOOD: Convenience Command
```bash
exarp-go task update T-123 --new-status "Done"
```

### ‚ö†Ô∏è ACCEPTABLE: Direct Tool (Advanced Operation)
```bash
exarp-go -tool task_workflow -args '{"action":"clarity","task_id":"T-123"}'
```

### ‚ùå BAD: Direct File Edit
```bash
# NEVER do this
vim .todo2/state.todo2.json
```
